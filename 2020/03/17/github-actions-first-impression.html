<!DOCTYPE html>
<html class="no-js">
  <head>
	<meta charset="utf-8">
	<title>üò≤ Github Actions - First impression | Hello world, it is nice to meet you ^_^</title>
	<meta name="description"
		content="Although Github Actions service is generally available since November 13, 2020, and there are about 243,000,000 results for ‚Äúgithub actions‚Äù in Google search...">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- CSS -->
	<link rel="stylesheet" href="/assets/css/main.css">

	<!--Favicon-->
	<link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">

	<!-- Canonical -->
	<link rel="canonical" href="/2020/03/17/github-actions-first-impression.html">

	<!-- RSS -->
	<link rel="alternate" type="application/atom+xml" title="Hello world, it is nice to meet you ^_^"
		href="/feed.xml" />

	<!-- Font Awesome -->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"
		integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">

	<!-- Google Fonts -->
	
	<link href="//fonts.googleapis.com/css?family=Work-Sans:300,700,700italic,400italic" rel="stylesheet"
		type="text/css">
	

	<!-- KaTeX -->
	

	<!-- Google Analytics -->
	
	<script>
		(function (i, s, o, g, r, a, m) {
		i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
			(i[r].q = i[r].q || []).push(arguments)
		}, i[r].l = 1 * new Date(); a = s.createElement(o),
			m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
		})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

		ga('create', 'G-GK7SE0XWGK', 'auto');
		ga('send', 'pageview');
	</script>
	
</head>
  <body>
    <header class="site-header">
	<div class="branding">
		
		<h1 class="site-title">
			<a href="/">Hello world, it is nice to meet you ^_^</a>
		</h1>
	</div>
	<nav class="site-nav">
		<ul>
			
			
			
			
			
			<li>
				<a class="page-link" href="/about/">
					About me
				</a>
			</li>
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			<!-- Social icons from Font Awesome, if enabled  -->
			
<li>
	<a href="/feed.xml" title="Follow RSS feed">
		<i class="fas fa-fw fa-rss"></i>
	</a>
</li>



<li>
	<a href="mailto:email-from-blog@vasylenko.info" title="Email">
		<i class="fas fa-fw fa-envelope"></i>
	</a>
</li>



















<li>
	<a href="https://www.linkedin.com/in/svasylenko/" title="Follow on LinkedIn">
		<i class="fab fa-fw fa-linkedin"></i>
	</a>
</li>

























            <!-- Search bar -->
            
		</ul>
	</nav>

</header>

    <div class="content">
      <article >
  <header style="background-image: url('/')">
    <h1 class="title">üò≤ Github Actions - First impression</h1>
    
    <p class="meta">
      March 17, 2020
      
    </p>
  </header>
  <section class="post-content"><p>Although Github Actions service is generally available since November 13, 2020, and there are about 243,000,000 results for ‚Äúgithub actions‚Äù in Google search already, I have just reached it‚Ä¶</p>

<p>It‚Äôs half past midnight, it took me about 35 commits to make my first github automation work, but it finally works and this blog post was built and published automatically!</p>

<h3 id="actions-everywhere">Actions everywhere</h3>
<p>One of the most (or maybe the most one) powerful things in Actions is ‚Ä¶ Actions! Github made a simple but genius thing: they turned well-known snippets (we do with pipelines) into the marketplace of well-made (sometimes not) simple and complex applications you can use in your automation workflow. <a href="https://github.com/marketplace?type=actions">https://github.com/marketplace?type=actions</a></p>

<p>So now you can either re-invent your wheel or re-use someone else‚Äôs code to make the needed automation.</p>

<p>I decided to automate publications to this blog via Actions in order to have some practice.</p>

<p>There are two workflows: one for the blog (website), and one for the CV (cv).</p>

<ul>
  <li><a href="https://github.com/actions/checkout">actions/checkout@v2</a></li>
  <li><a href="https://github.com/actions/upload-artifact">actions/upload-artifact@v2</a></li>
  <li><a href="https://github.com/actions/download-artifact">actions/download-artifact@v2</a></li>
</ul>

<p>In both workflows, the build job is performed within a container, which is different per workflow: Ruby for the blog and Pandoc for CV.</p>

<p>Here is how the build job looks like for the blog:</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">container</span><span class="pi">:</span>
      <span class="na">image</span><span class="pi">:</span> <span class="s">ruby:2.6.4</span>
      <span class="na">options</span><span class="pi">:</span> 
        <span class="s">--workdir /src</span> 
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Checkout</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span> 

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Build blog</span>
        <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">bundle install</span>
          <span class="s">bundle exec jekyll build --verbose --destination _site</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Upload artifacts</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/upload-artifact@v2</span>
        <span class="na">with</span><span class="pi">:</span> 
          <span class="na">name</span><span class="pi">:</span> <span class="s">_site</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">_site</span>
</code></pre></div></div>
<p>As you can see, I run the steps within the Ruby container. This simplifies things related to file permissions and directory mounting because checkout is made inside the container.</p>

<p>The deploy step is performed via shell run command for now, for better clearness (can be replaced to third-party action or custom-made one): it makes a commit to gh-pages branch which is configured for Github Pages.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
    <span class="na">if</span><span class="pi">:</span> <span class="s">github.ref == 'refs/heads/master'</span>
    <span class="na">needs</span><span class="pi">:</span> <span class="s">build</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Checkout gh-pages branch</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">ref</span><span class="pi">:</span> <span class="s1">'</span><span class="s">gh-pages'</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Get the build artifact</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/download-artifact@v2</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">_site</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">./</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy (push) to gh-pages</span>
        <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">git config user.name "$GITHUB_ACTOR"</span>
          <span class="s">git config user.email "${GITHUB_ACTOR}@bots.github.com"</span>
          <span class="s">git add -A </span>
          <span class="s">git commit -a -m "Updated Website"</span>
          <span class="s">git remote set-url origin "https://x-access-token:$@github.com/vasylenko/serhii.vasylenko.info.git"</span>
          <span class="s">git push --force-with-lease origin gh-pages</span>
</code></pre></div></div>

<h3 id="old-good-things-made-better">Old good things made better</h3>
<p>A lot of common things have been introduced to GitHubActions with some sweet additions:</p>

<ul>
  <li>you can also specify different environments for your jobs in the same workflow;</li>
  <li>you can use environment variables with a different visibility scope: either workflow, or job, or step;</li>
  <li>you can use cache for dependencies and reuse it between workflow runs while keeping workflow directory clean;</li>
  <li>you can trigger a workflow by repo events and have a quite complex conditional logic or filters (if needed), external webhooks and by a schedule;</li>
  <li>you can pass artifacts between jobs inside a workflow with ease - Github provides simple actions for this, so you don‚Äôt need to dance around temporary directories or files;</li>
  <li>and much more</li>
</ul>
</section>
  
<footer>
  <div class="tags">
    
    <a class="tag" href="/tags#github">#github</a>
    
    <a class="tag" href="/tags#automation">#automation</a>
    
    <a class="tag" href="/tags#review">#review</a>
    
  </div>
</footer>


</article>

<!-- Disqus -->


<!-- Post navigation -->

  <div id="post-nav">
  
  <div id="previous-post" class="post-nav-post">
      <p>Previous post</p>
      <a href="/2020/03/15/aws-solutions-architect-associate-exam-tips.html">
        ü•≥ AWS SAA exam results
      </a>
  </div>
  
  
  <div id="next-post" class="post-nav-post">
      <p>Next post</p>
      <a href="/2020/03/20/devops-team-in-outsource-a-team.html">
        ü§î DevOps team in outsource. A team?
      </a>
  </div>
  
</div>



    </div>
    



  </body>
</html>
